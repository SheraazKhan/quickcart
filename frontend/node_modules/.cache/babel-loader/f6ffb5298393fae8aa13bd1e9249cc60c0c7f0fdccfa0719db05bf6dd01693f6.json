{"ast":null,"code":"var _jsxFileName = \"D:\\\\Quickcart\\\\frontend\\\\src\\\\pages\\\\Checkout.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { useStripe, useElements, PaymentElement, Elements } from \"@stripe/react-stripe-js\";\nimport { stripePromise } from \"../stripe/stripeConfig\";\nimport API_BASE_URL from \"../utils/api\";\n\n/* ---------- Helpers ---------- */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useCart = () => {\n  _s();\n  const [cart, setCart] = useState(() => {\n    try {\n      return JSON.parse(localStorage.getItem(\"cart\")) || [];\n    } catch {\n      return [];\n    }\n  });\n  useEffect(() => {\n    const stored = JSON.parse(localStorage.getItem(\"cart\") || \"[]\");\n    setCart(stored);\n  }, []);\n  const subtotal = useMemo(() => cart.reduce((sum, i) => sum + Number(i.price || 0) * Number(i.quantity || 1), 0), [cart]);\n  const shipping = subtotal >= 30 ? 0 : 4.99; // free shipping threshold to match the banner\n  const total = Number((subtotal + shipping).toFixed(2));\n  return {\n    cart,\n    subtotal: Number(subtotal.toFixed(2)),\n    shipping,\n    total\n  };\n};\n_s(useCart, \"hob00K1IxdrIbvs4ooh6Sn6grWg=\");\nconst getItemImage = img => {\n  if (!img) return \"/placeholder.jpg\";\n  if (typeof img === \"string\") {\n    if (/^https?:\\/\\//i.test(img)) return img;\n    // If your server serves /images, API_BASE_URL + path works:\n    return `${API_BASE_URL}${img.startsWith(\"/\") ? \"\" : \"/\"}${img}`;\n  }\n  if (img !== null && img !== void 0 && img.url) return img.url;\n  return \"/placeholder.jpg\";\n};\n\n/* ---------- Form (left column) ---------- */\nconst CheckoutForm = ({\n  clientSecret\n}) => {\n  _s2();\n  const stripe = useStripe();\n  const elements = useElements();\n  const navigate = useNavigate();\n  const {\n    cart,\n    subtotal,\n    shipping,\n    total\n  } = useCart();\n  const [form, setForm] = useState(() => {\n    // optionally restore previous shipping info\n    try {\n      return JSON.parse(localStorage.getItem(\"shipping\")) || {\n        name: \"\",\n        address: \"\"\n      };\n    } catch {\n      return {\n        name: \"\",\n        address: \"\"\n      };\n    }\n  });\n  const [msg, setMsg] = useState(\"\");\n  const [submitting, setSubmitting] = useState(false);\n  const user = (() => {\n    try {\n      return JSON.parse(localStorage.getItem(\"user\"));\n    } catch {\n      return null;\n    }\n  })();\n  const handleChange = e => {\n    setMsg(\"\");\n    setForm(f => ({\n      ...f,\n      [e.target.name]: e.target.value\n    }));\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n    if (!form.name.trim() || !form.address.trim()) {\n      setMsg(\"Name and address are required.\");\n      return;\n    }\n    setSubmitting(true);\n    localStorage.setItem(\"shipping\", JSON.stringify(form));\n\n    // Provide billing details to Stripe for better receipts & risk checks\n    const result = await stripe.confirmPayment({\n      elements,\n      confirmParams: {\n        payment_method_data: {\n          billing_details: {\n            name: form.name.trim(),\n            email: user === null || user === void 0 ? void 0 : user.email,\n            address: {\n              line1: form.address.trim()\n            }\n          }\n        },\n        return_url: `${window.location.origin}/order-success`\n      }\n    });\n    if (result.error) {\n      setMsg(result.error.message || \"Payment failed.\");\n      setSubmitting(false);\n    }\n    // On success, Stripe will redirect to /order-success\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"space-y-5\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"block text-sm font-medium mb-1\",\n        children: \"Full Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"name\",\n        value: form.name,\n        onChange: handleChange,\n        className: \"w-full px-3 py-2 border border-gray-200 rounded-lg\",\n        placeholder: \"Jane Doe\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"block text-sm font-medium mb-1\",\n        children: \"Address\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        name: \"address\",\n        value: form.address,\n        onChange: handleChange,\n        className: \"w-full px-3 py-2 border border-gray-200 rounded-lg\",\n        placeholder: \"123 Market St, City, State\",\n        rows: 3,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-t pt-4\",\n      children: /*#__PURE__*/_jsxDEV(PaymentElement, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-right text-sm text-gray-600\",\n      children: [\"Subtotal: \", /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"font-medium\",\n        children: [\"$\", subtotal.toFixed(2)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"mx-2\",\n        children: \"\\u2022\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this), \"Shipping:\", \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"font-medium\",\n        children: shipping === 0 ? \"Free\" : `$${shipping.toFixed(2)}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-lg font-bold mt-1\",\n        children: [\"Total: $\", total.toFixed(2)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe || submitting,\n      className: \"w-full bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 text-white font-semibold px-5 py-3 rounded-lg\",\n      children: submitting ? \"Processing…\" : \"Pay Now\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this), msg && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border rounded-lg px-4 py-3 text-sm bg-red-50 text-red-700 border-red-200\",\n      children: msg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center\",\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/cart\",\n        className: \"text-sm text-indigo-600 hover:underline\",\n        children: \"Back to cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, this);\n};\n\n/* ---------- Page shell (two-column layout) ---------- */\n_s2(CheckoutForm, \"lFWaUcCbkBNmGcGF6ynr5CYBGzA=\", false, function () {\n  return [useStripe, useElements, useNavigate, useCart];\n});\n_c = CheckoutForm;\nconst Checkout = () => {\n  _s3();\n  const [clientSecret, setClientSecret] = useState(\"\");\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  const {\n    cart,\n    subtotal,\n    shipping,\n    total\n  } = useCart();\n  const user = (() => {\n    try {\n      return JSON.parse(localStorage.getItem(\"user\"));\n    } catch {\n      return null;\n    }\n  })();\n  useEffect(() => {\n    const init = async () => {\n      if (!user) {\n        navigate(\"/login\", {\n          state: {\n            from: \"/checkout\"\n          }\n        });\n        return;\n      }\n      if (cart.length === 0) {\n        navigate(\"/cart\");\n        return;\n      }\n      try {\n        const res = await axios.post(`${API_BASE_URL}/api/payments/create-payment-intent`, {\n          amount: total // keep as your backend expects (your original code sent total)\n        });\n        setClientSecret(res.data.clientSecret);\n      } catch (err) {\n        console.error(\"Stripe init failed:\", err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    init();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"bg-gray-50 min-h-screen\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-6xl mx-auto px-4 py-10\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid gap-6 md:grid-cols-[1fr_360px]\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white rounded-xl p-6 ring-1 ring-black/5 shadow animate-pulse\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-6 bg-gray-200 rounded w-1/3 mb-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-10 bg-gray-200 rounded mb-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-24 bg-gray-200 rounded mb-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-10 bg-gray-200 rounded\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white rounded-xl p-6 ring-1 ring-black/5 shadow animate-pulse\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-6 bg-gray-200 rounded w-1/2 mb-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-24 bg-gray-200 rounded\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this);\n  }\n  if (!clientSecret) {\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"bg-gray-50 min-h-screen\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-3xl mx-auto px-4 py-16 text-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-xl p-10 ring-1 ring-black/5 shadow\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold mb-2 text-red-600\",\n            children: \"Failed to initiate payment.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-600\",\n            children: \"Please return to your cart and try again.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/cart\",\n            className: \"inline-block mt-4 text-indigo-600 hover:underline\",\n            children: \"Back to cart\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    className: \"bg-gray-50 min-h-screen\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-6xl mx-auto px-4 py-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl font-extrabold text-slate-900 mb-4\",\n        children: \"Checkout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid gap-6 md:grid-cols-[1fr_360px]\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-xl p-6 ring-1 ring-black/5 shadow-[0_1px_2px_rgba(0,0,0,0.06),0_10px_20px_rgba(0,0,0,0.06)]\",\n          children: /*#__PURE__*/_jsxDEV(Elements, {\n            stripe: stripePromise,\n            options: {\n              clientSecret,\n              appearance: {\n                theme: \"stripe\",\n                variables: {\n                  colorPrimary: \"#4f46e5\",\n                  fontFamily: \"Inter, system-ui, sans-serif\",\n                  borderRadius: \"8px\"\n                }\n              }\n            },\n            children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n              clientSecret: clientSecret\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n          className: \"bg-white rounded-xl p-6 ring-1 ring-black/5 shadow-[0_1px_2px_rgba(0,0,0,0.06),0_10px_20px_rgba(0,0,0,0.06)] h-fit\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-lg font-semibold mb-4\",\n            children: \"Order Summary\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"divide-y divide-gray-200 mb-4\",\n            children: cart.map(item => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"py-3 flex items-center gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: getItemImage(item.image),\n                alt: item.name,\n                className: \"h-12 w-12 object-contain rounded bg-white ring-1 ring-black/5\",\n                onError: e => e.currentTarget.src = \"/placeholder.jpg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm font-medium line-clamp-1\",\n                  children: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-xs text-gray-500\",\n                  children: [\"Qty \", item.quantity]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm font-semibold\",\n                children: [\"$\", (Number(item.price) * Number(item.quantity)).toFixed(2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 302,\n                columnNumber: 19\n              }, this)]\n            }, item._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-1 text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"Subtotal\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 311,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-medium\",\n                children: [\"$\", subtotal.toFixed(2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 312,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-600\",\n                children: \"Shipping\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-medium\",\n                children: shipping === 0 ? \"Free\" : `$${shipping.toFixed(2)}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between text-base font-bold pt-2 border-t\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Total\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\"$\", total.toFixed(2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 322,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 mt-3\",\n            children: \"Free shipping on orders over $30.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 260,\n    columnNumber: 5\n  }, this);\n};\n_s3(Checkout, \"W/akaBCYfIfoAfawKBi2hvj4/DI=\", false, function () {\n  return [useNavigate, useCart];\n});\n_c2 = Checkout;\nexport default Checkout;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"Checkout\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","Link","useNavigate","axios","useStripe","useElements","PaymentElement","Elements","stripePromise","API_BASE_URL","jsxDEV","_jsxDEV","useCart","_s","cart","setCart","JSON","parse","localStorage","getItem","stored","subtotal","reduce","sum","i","Number","price","quantity","shipping","total","toFixed","getItemImage","img","test","startsWith","url","CheckoutForm","clientSecret","_s2","stripe","elements","navigate","form","setForm","name","address","msg","setMsg","submitting","setSubmitting","user","handleChange","e","f","target","value","handleSubmit","preventDefault","trim","setItem","stringify","result","confirmPayment","confirmParams","payment_method_data","billing_details","email","line1","return_url","window","location","origin","error","message","onSubmit","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","onChange","placeholder","required","rows","disabled","to","_c","Checkout","_s3","setClientSecret","loading","setLoading","init","state","from","length","res","post","amount","data","err","console","options","appearance","theme","variables","colorPrimary","fontFamily","borderRadius","map","item","src","image","alt","onError","currentTarget","_id","_c2","$RefreshReg$"],"sources":["D:/Quickcart/frontend/src/pages/Checkout.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport {\r\n  useStripe,\r\n  useElements,\r\n  PaymentElement,\r\n  Elements,\r\n} from \"@stripe/react-stripe-js\";\r\nimport { stripePromise } from \"../stripe/stripeConfig\";\r\nimport API_BASE_URL from \"../utils/api\";\r\n\r\n/* ---------- Helpers ---------- */\r\nconst useCart = () => {\r\n  const [cart, setCart] = useState(() => {\r\n    try {\r\n      return JSON.parse(localStorage.getItem(\"cart\")) || [];\r\n    } catch {\r\n      return [];\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    const stored = JSON.parse(localStorage.getItem(\"cart\") || \"[]\");\r\n    setCart(stored);\r\n  }, []);\r\n\r\n  const subtotal = useMemo(\r\n    () => cart.reduce((sum, i) => sum + Number(i.price || 0) * Number(i.quantity || 1), 0),\r\n    [cart]\r\n  );\r\n  const shipping = subtotal >= 30 ? 0 : 4.99; // free shipping threshold to match the banner\r\n  const total = Number((subtotal + shipping).toFixed(2));\r\n\r\n  return { cart, subtotal: Number(subtotal.toFixed(2)), shipping, total };\r\n};\r\n\r\nconst getItemImage = (img) => {\r\n  if (!img) return \"/placeholder.jpg\";\r\n  if (typeof img === \"string\") {\r\n    if (/^https?:\\/\\//i.test(img)) return img;\r\n    // If your server serves /images, API_BASE_URL + path works:\r\n    return `${API_BASE_URL}${img.startsWith(\"/\") ? \"\" : \"/\"}${img}`;\r\n  }\r\n  if (img?.url) return img.url;\r\n  return \"/placeholder.jpg\";\r\n};\r\n\r\n/* ---------- Form (left column) ---------- */\r\nconst CheckoutForm = ({ clientSecret }) => {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const navigate = useNavigate();\r\n  const { cart, subtotal, shipping, total } = useCart();\r\n\r\n  const [form, setForm] = useState(() => {\r\n    // optionally restore previous shipping info\r\n    try {\r\n      return JSON.parse(localStorage.getItem(\"shipping\")) || { name: \"\", address: \"\" };\r\n    } catch {\r\n      return { name: \"\", address: \"\" };\r\n    }\r\n  });\r\n  const [msg, setMsg] = useState(\"\");\r\n  const [submitting, setSubmitting] = useState(false);\r\n\r\n  const user = (() => {\r\n    try {\r\n      return JSON.parse(localStorage.getItem(\"user\"));\r\n    } catch {\r\n      return null;\r\n    }\r\n  })();\r\n\r\n  const handleChange = (e) => {\r\n    setMsg(\"\");\r\n    setForm((f) => ({ ...f, [e.target.name]: e.target.value }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!stripe || !elements) return;\r\n    if (!form.name.trim() || !form.address.trim()) {\r\n      setMsg(\"Name and address are required.\");\r\n      return;\r\n    }\r\n    setSubmitting(true);\r\n    localStorage.setItem(\"shipping\", JSON.stringify(form));\r\n\r\n    // Provide billing details to Stripe for better receipts & risk checks\r\n    const result = await stripe.confirmPayment({\r\n      elements,\r\n      confirmParams: {\r\n        payment_method_data: {\r\n          billing_details: {\r\n            name: form.name.trim(),\r\n            email: user?.email,\r\n            address: { line1: form.address.trim() },\r\n          },\r\n        },\r\n        return_url: `${window.location.origin}/order-success`,\r\n      },\r\n    });\r\n\r\n    if (result.error) {\r\n      setMsg(result.error.message || \"Payment failed.\");\r\n      setSubmitting(false);\r\n    }\r\n    // On success, Stripe will redirect to /order-success\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-1\">Full Name</label>\r\n        <input\r\n          type=\"text\"\r\n          name=\"name\"\r\n          value={form.name}\r\n          onChange={handleChange}\r\n          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg\"\r\n          placeholder=\"Jane Doe\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block text-sm font-medium mb-1\">Address</label>\r\n        <textarea\r\n          name=\"address\"\r\n          value={form.address}\r\n          onChange={handleChange}\r\n          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg\"\r\n          placeholder=\"123 Market St, City, State\"\r\n          rows={3}\r\n          required\r\n        />\r\n      </div>\r\n\r\n      <div className=\"border-t pt-4\">\r\n        <PaymentElement />\r\n      </div>\r\n\r\n      <div className=\"text-right text-sm text-gray-600\">\r\n        Subtotal: <span className=\"font-medium\">${subtotal.toFixed(2)}</span>\r\n        <span className=\"mx-2\">•</span>\r\n        Shipping:{\" \"}\r\n        <span className=\"font-medium\">\r\n          {shipping === 0 ? \"Free\" : `$${shipping.toFixed(2)}`}\r\n        </span>\r\n        <div className=\"text-lg font-bold mt-1\">Total: ${total.toFixed(2)}</div>\r\n      </div>\r\n\r\n      <button\r\n        type=\"submit\"\r\n        disabled={!stripe || submitting}\r\n        className=\"w-full bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 text-white font-semibold px-5 py-3 rounded-lg\"\r\n      >\r\n        {submitting ? \"Processing…\" : \"Pay Now\"}\r\n      </button>\r\n\r\n      {msg && (\r\n        <div className=\"border rounded-lg px-4 py-3 text-sm bg-red-50 text-red-700 border-red-200\">\r\n          {msg}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"text-center\">\r\n        <Link to=\"/cart\" className=\"text-sm text-indigo-600 hover:underline\">\r\n          Back to cart\r\n        </Link>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\n/* ---------- Page shell (two-column layout) ---------- */\r\nconst Checkout = () => {\r\n  const [clientSecret, setClientSecret] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n  const { cart, subtotal, shipping, total } = useCart();\r\n\r\n  const user = (() => {\r\n    try {\r\n      return JSON.parse(localStorage.getItem(\"user\"));\r\n    } catch {\r\n      return null;\r\n    }\r\n  })();\r\n\r\n  useEffect(() => {\r\n    const init = async () => {\r\n      if (!user) {\r\n        navigate(\"/login\", { state: { from: \"/checkout\" } });\r\n        return;\r\n      }\r\n      if (cart.length === 0) {\r\n        navigate(\"/cart\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const res = await axios.post(`${API_BASE_URL}/api/payments/create-payment-intent`, {\r\n          amount: total, // keep as your backend expects (your original code sent total)\r\n        });\r\n        setClientSecret(res.data.clientSecret);\r\n      } catch (err) {\r\n        console.error(\"Stripe init failed:\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    init();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <main className=\"bg-gray-50 min-h-screen\">\r\n        <div className=\"max-w-6xl mx-auto px-4 py-10\">\r\n          <div className=\"grid gap-6 md:grid-cols-[1fr_360px]\">\r\n            <div className=\"bg-white rounded-xl p-6 ring-1 ring-black/5 shadow animate-pulse\">\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/3 mb-4\" />\r\n              <div className=\"h-10 bg-gray-200 rounded mb-3\" />\r\n              <div className=\"h-24 bg-gray-200 rounded mb-3\" />\r\n              <div className=\"h-10 bg-gray-200 rounded\" />\r\n            </div>\r\n            <div className=\"bg-white rounded-xl p-6 ring-1 ring-black/5 shadow animate-pulse\">\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/2 mb-3\" />\r\n              <div className=\"h-24 bg-gray-200 rounded\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  if (!clientSecret) {\r\n    return (\r\n      <main className=\"bg-gray-50 min-h-screen\">\r\n        <div className=\"max-w-3xl mx-auto px-4 py-16 text-center\">\r\n          <div className=\"bg-white rounded-xl p-10 ring-1 ring-black/5 shadow\">\r\n            <h2 className=\"text-xl font-semibold mb-2 text-red-600\">\r\n              Failed to initiate payment.\r\n            </h2>\r\n            <p className=\"text-gray-600\">\r\n              Please return to your cart and try again.\r\n            </p>\r\n            <Link to=\"/cart\" className=\"inline-block mt-4 text-indigo-600 hover:underline\">\r\n              Back to cart\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"bg-gray-50 min-h-screen\">\r\n      <div className=\"max-w-6xl mx-auto px-4 py-8\">\r\n        <h1 className=\"text-2xl font-extrabold text-slate-900 mb-4\">Checkout</h1>\r\n\r\n        <div className=\"grid gap-6 md:grid-cols-[1fr_360px]\">\r\n          {/* Left: Payment & shipping form */}\r\n          <div className=\"bg-white rounded-xl p-6 ring-1 ring-black/5 shadow-[0_1px_2px_rgba(0,0,0,0.06),0_10px_20px_rgba(0,0,0,0.06)]\">\r\n            <Elements\r\n              stripe={stripePromise}\r\n              options={{\r\n                clientSecret,\r\n                appearance: {\r\n                  theme: \"stripe\",\r\n                  variables: {\r\n                    colorPrimary: \"#4f46e5\",\r\n                    fontFamily: \"Inter, system-ui, sans-serif\",\r\n                    borderRadius: \"8px\",\r\n                  },\r\n                },\r\n              }}\r\n            >\r\n              <CheckoutForm clientSecret={clientSecret} />\r\n            </Elements>\r\n          </div>\r\n\r\n          {/* Right: Order summary */}\r\n          <aside className=\"bg-white rounded-xl p-6 ring-1 ring-black/5 shadow-[0_1px_2px_rgba(0,0,0,0.06),0_10px_20px_rgba(0,0,0,0.06)] h-fit\">\r\n            <h2 className=\"text-lg font-semibold mb-4\">Order Summary</h2>\r\n\r\n            <ul className=\"divide-y divide-gray-200 mb-4\">\r\n              {cart.map((item) => (\r\n                <li key={item._id} className=\"py-3 flex items-center gap-3\">\r\n                  <img\r\n                    src={getItemImage(item.image)}\r\n                    alt={item.name}\r\n                    className=\"h-12 w-12 object-contain rounded bg-white ring-1 ring-black/5\"\r\n                    onError={(e) => (e.currentTarget.src = \"/placeholder.jpg\")}\r\n                  />\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"text-sm font-medium line-clamp-1\">{item.name}</div>\r\n                    <div className=\"text-xs text-gray-500\">Qty {item.quantity}</div>\r\n                  </div>\r\n                  <div className=\"text-sm font-semibold\">\r\n                    ${(Number(item.price) * Number(item.quantity)).toFixed(2)}\r\n                  </div>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n\r\n            <div className=\"space-y-1 text-sm\">\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Subtotal</span>\r\n                <span className=\"font-medium\">${subtotal.toFixed(2)}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Shipping</span>\r\n                <span className=\"font-medium\">\r\n                  {shipping === 0 ? \"Free\" : `$${shipping.toFixed(2)}`}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex justify-between text-base font-bold pt-2 border-t\">\r\n                <span>Total</span>\r\n                <span>${total.toFixed(2)}</span>\r\n              </div>\r\n            </div>\r\n\r\n            <p className=\"text-xs text-gray-500 mt-3\">\r\n              Free shipping on orders over $30.\r\n            </p>\r\n          </aside>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default Checkout;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}